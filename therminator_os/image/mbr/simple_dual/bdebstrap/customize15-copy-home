#!/bin/bash
set -eu

ROOTFS="$1"

# Create home directory if it doesn't exist
mkdir -p "$ROOTFS/home/therminator"

# Rsync the home files (e.g., app, configs, scripts)
rsync -a "${IGIMAGE}/home/therminator/" "$ROOTFS/home/therminator/"

# Fix permissions: readable by user, executables for scripts/binaries
chmod -R u+rwX "$ROOTFS/home/therminator"
chmod +x "$ROOTFS/home/therminator/therminator_server" || true
